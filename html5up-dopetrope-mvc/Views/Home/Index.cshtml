@using html5up_dopetrope_mvc
@using html5up_dopetrope_mvc.Helpers
@model html5up_dopetrope_mvc.ViewModels.HomeViewModel

@{
    ViewBag.BodyCssClassName = "homepage";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<!-- Main Wrapper -->
<div id="main-wrapper">
    <div class="container">
        <div class="row">
            <div class="12u">
                <!-- Banner -->
                <section id="banner">
                    <div id="banner-fade" class="image image-full">
                        <ul class="bjqs">
                            @foreach (var image in Html.GetCarouselImages())
                            {
                                <li>
                                    <a href="#" class="">
                                        <img src='@Url.Action("GetImage", "Carousel", new { id = image.ID })'  alt="">
                                    </a>
                                </li>
                            }
                        </ul>
                    </div>
                    <div class="form-box">
                        @using (Html.BeginForm("Reservation", "Rooms", FormMethod.Post))
                        {
                            @Html.AntiForgeryToken()

                            if (!string.IsNullOrEmpty(this.ViewBag.Message))
                            {
                                <span class="field-validation-error text-danger">
                                    @this.ViewBag.Message.ToString()
                                </span>
                            }

                            <div class="form-group">
                                <label>入住日期</label>
                                @*<input id="checkin-date" type="date" name="checkin-date" />*@
                                @Html.TextBoxFor(model => model.RoomBookingOrder.OrderDateForm, "{0:yyyy-MM-dd}", new { @type = "date" })
                                @Html.ValidationMessageFor(model => model.RoomBookingOrder.OrderDateForm, "", new { @class = "text-danger" })
                            </div>
                            <div class="form-group">
                                <label>退房日期</label>
                                @*<input id="checkout-date" type="date" name="checkout-date" />*@
                                @Html.TextBoxFor(model => model.RoomBookingOrder.OrderDateTo, "{0:yyyy-MM-dd}", new { @type = "date" })
                                @Html.ValidationMessageFor(model => model.RoomBookingOrder.OrderDateTo, "", new { @class = "text-danger" })
                                共
                                <span class="live-num">0</span> 晚
                            </div>
                            <div class="form-group">
                                <label>房型</label>
                                @Html.DropDownListFor(model => model.RoomBookingOrder.RoomId,
                                                Model.TbRoomsList.Take(6).Select(s => new SelectListItem() { Text = s.Name, Value = s.ID.ToString() }))
                                @Html.ValidationMessageFor(model => model.RoomBookingOrder.RoomId, "", new { @class = "text-danger" })
                                @Html.HiddenFor(model => model.RoomBookingOrder.RoomNum)
                            </div>

                            <div class="form-group">
                                <label>大人人數</label>
                                @*<input type="number" name="rooms" />*@
                                @Html.TextBoxFor(model => model.RoomBookingOrder.AdultNum, new { @type = "number"   })
                                @Html.ValidationMessageFor(model => model.RoomBookingOrder.AdultNum, "", new { @class = "text-danger" })
                                位
                            </div>
                            <div class="form-group">
                                <label>小孩人數</label>
                                @*<input type="number" name="rooms" />*@
                                @Html.TextBoxFor(model => model.RoomBookingOrder.ChildNum, new { @type = "number" })
                                @Html.ValidationMessageFor(model => model.RoomBookingOrder.ChildNum, "", new { @class = "text-danger" })
                                位
                            </div>

                            <div class="form-group">
                                <label>
                                    是否加床
                                </label>
                                @*<input type="number" name="rooms" />*@
                                @Html.CheckBoxFor(model => model.RoomBookingOrder.IsExtraBed)
                                @Html.ValidationMessageFor(model => model.RoomBookingOrder.IsExtraBed, "", new { @class = "text-danger" })

                            </div>

                            <div class="form-group">

                                <label>
                                    加床數
                                </label>
                                @Html.TextBoxFor(model => model.RoomBookingOrder.ExtraBadNum, new { @type = "number" })
                                @Html.ValidationMessageFor(model => model.RoomBookingOrder.ExtraBadNum, "", new { @class = "text-danger" })
                                位
                            </div>

                            <div class="form-group">
                                <label>訂房人姓名</label>
                                @*<input type="number" name="rooms" />*@
                                @Html.TextBoxFor(model => model.RoomBookingOrder.CustomeName, new { })

                                @Html.ValidationMessageFor(model => model.RoomBookingOrder.CustomeName, "", new { @class = "text-danger" })
                            </div>
                            <div class="form-group">
                                <label>訂房人Email</label>
                                @*<input type="number" name="rooms" />*@
                                @Html.TextBoxFor(model => model.RoomBookingOrder.CustomeEmail, new { @type = "email" })
                                @Html.ValidationMessageFor(model => model.RoomBookingOrder.CustomeEmail, "", new { @class = "text-danger" })
                            </div>
                            <div class="form-group">
                                <label>訂房人電話</label>
                                @*<input type="number" name="rooms" />*@
                                @Html.TextBoxFor(model => model.RoomBookingOrder.CustomeTel, new { @type = "tel" })
                                @Html.ValidationMessageFor(model => model.RoomBookingOrder.CustomeTel, "", new { @class = "text-danger" })
                            </div>



                            <div class="btn-wrap">
                                <button type="submit" class="button">立即訂房</button>
                                <button type="submit" class="button alt" onclick="location.href = '@Url.Action("Reservation","Rooms")'; return false;">查詢訂房日曆</button>
                            </div>

                        }
                    </div>
                    @*<header>
                            <h2>預約波克夏．讓您和您的親朋好友享受片刻的愜意生活</h2>
                            <span class="byline">預約波克夏．讓您和您的親朋好友享受片刻的愜意生活</span>
                        </header>
                    *@
                </section>
            </div>
        </div>
        @*<div class="row">
                <div class="12u">
                    <!-- Intro -->
                    <section id="intro">
                            <div>
                                <div class="row">
                                    <div class="4u">
                                        <section class="first">
                                            <span class="pennant"><span class="fa fa-cog"></span></span>
                                            <header>
                                                <h2>Ipsum consequat</h2>
                                            </header>
                                            <p>Nisl amet dolor sit ipsum veroeros sed blandit consequat veroeros et magna tempus.</p>
                                        </section>
                                    </div>
                                    <div class="4u">
                                        <section class="middle">
                                            <span class="pennant pennant-alt"><span class="fa fa-flash"></span></span>
                                            <header>
                                                <h2>Magna etiam dolor</h2>
                                            </header>
                                            <p>Nisl amet dolor sit ipsum veroeros sed blandit consequat veroeros et magna tempus.</p>
                                        </section>
                                    </div>
                                    <div class="4u">
                                        <section class="last">
                                            <span class="pennant pennant-alt2"><span class="fa fa-star"></span></span>
                                            <header>
                                                <h2>Tempus adipiscing</h2>
                                            </header>
                                            <p>Nisl amet dolor sit ipsum veroeros sed blandit consequat veroeros et magna tempus.</p>
                                        </section>
                                    </div>
                                </div>
                            </div>
                            <div class="actions">
                                <a href="#" class="button big">Get Started</a>
                                <a href="#" class="button alt big">Learn More</a>
                            </div>
                        </section>

                </div>
            </div>*@
        <div class="row">
            <div class="12u">
                <!-- Portfolio -->
                <section>
                    <header class="major">
                        <h2>我們的客房</h2>
                    </header>
                    <div>
                        @{
                            var roomlist = Model.TbRoomsList.ToList();
                        }
                        <div class='row'>
                            @for (int iroom = 0; iroom < 3; iroom++)
                            {
                                <div class="4u">
                                    <section class="box">
                                        <a href="#" class="image image-full">

                                            @{
                                var targetDirectory = Server.MapPath(@"~/UploadFiles/TB_Room/" + roomlist[iroom].ID + "/");
                                var images = Html.GetImgTagsByRoomId(@"~/UploadFiles/TB_Room/" + roomlist[iroom].ID + "/", targetDirectory);

                                @images.ToList()[0]

                                            }
                                        </a>
                                        <header>
                                            <h3>@roomlist[iroom].Name</h3>
                                        </header>
                                        <p>@roomlist[iroom].Features</p>
                                        <footer>
                                            <a href="@Url.Action("Details", "Rooms", new { tbRoomId = roomlist[iroom].ID})" class="button alt">看更多</a>
                                        </footer>
                                    </section>
                                </div>
                            }
                        </div>
                        <div class='row'>
                            @for (int iroom = 3; iroom < 6; iroom++)
                            {
                                <div class="4u">
                                    <section class="box">
                                        <a href="#" class="image image-full">
                                            @{
                                var targetDirectory = Server.MapPath(@"~/UploadFiles/TB_Room/" + roomlist[iroom].ID + "/");
                                var images = Html.GetImgTagsByRoomId(@"~/UploadFiles/TB_Room/" + roomlist[iroom].ID + "/", targetDirectory);

                                @images.ToList()[0]

                                            }
                                        </a>
                                        <header>
                                            <h3>@roomlist[iroom].Name</h3>
                                        </header>
                                        <p>@roomlist[iroom].Features</p>
                                        <footer>
                                            <a href="@Url.Action("Details", "Rooms", new { tbRoomId = roomlist[iroom].ID})" class="button alt">看更多</a>
                                        </footer>
                                    </section>
                                </div>
                            }
                        </div>

                    </div>
                </section>
            </div>
        </div>
        @*<div class="row">
                <div class="12u">
                    <!-- Blog -->
                    <section>
                            <header class="major">
                                <h2>The Blog</h2>
                            </header>
                            <div>
                                <div class="row">
                                    <div class="6u">
                                        <section class="box">
                                            <a href="#" class="image image-full">
                                                </a>
                                            <header>
                                                <h3>Magna tempus consequat lorem</h3>
                                                <span class="byline">Posted 45 minutes ago</span>
                                            </header>
                                            <p>Lorem ipsum dolor sit amet sit veroeros sed et blandit consequat sed veroeros lorem et blandit  adipiscing feugiat phasellus tempus hendrerit, tortor vitae mattis tempor, sapien sem feugiat sapien, id suscipit magna felis nec elit. Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos lorem ipsum dolor sit amet.</p>
                                            <footer class="actions">
                                                <a href="#" class="button fa fa-file-text">Continue Reading</a>
                                                <a href="#" class="button alt fa fa-comment">33 comments</a>
                                            </footer>
                                        </section>
                                    </div>
                                    <div class="6u">
                                        <section class="box">
                                            <a href="#" class="image image-full">
                                                </a>
                                            <header>
                                                <h3>Aptent veroeros et aliquam</h3>
                                                <span class="byline">Posted 45 minutes ago</span>
                                            </header>
                                            <p>Lorem ipsum dolor sit amet sit veroeros sed et blandit consequat sed veroeros lorem et blandit  adipiscing feugiat phasellus tempus hendrerit, tortor vitae mattis tempor, sapien sem feugiat sapien, id suscipit magna felis nec elit. Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos lorem ipsum dolor sit amet.</p>
                                            <footer class="actions">
                                                <a href="#" class="button fa fa-file-text">Continue Reading</a>
                                                <a href="#" class="button alt fa fa-comment">33 comments</a>
                                            </footer>
                                        </section>
                                    </div>
                                </div>
                            </div>
                        </section>
                </div>
            </div>*@
    </div>
</div>

<br />

@section Style
{

    <link href="~/Scripts/basic-jquery-slider-master/bjqs.css" rel="stylesheet" />
}

@section Scripts {

    <script src="~/Scripts/basic-jquery-slider-master/js/bjqs-1.3.min.js"></script>
    <script>


        $(document).ready(function () {

            $('#banner-fade').bjqs({
                height: 300,
                width: '58%',
                //usecaptions : true, // show captions for images using the image title tag
                //randomstart : true, // start slider at random slide
                showcontrols: false, // show next and prev controls
                showmarkers: false, // Show individual slide markers
                responsive: true
            });

            var checkinDate;
            var checkoutDate;
            var dateDiff = 0;

            $("#RoomBookingOrder_OrderDateForm").change(function (e) {
                if ($(this).val() != "" && !isNaN(Date.parse($(this).val())) && !isNaN(Date.parse($("#RoomBookingOrder_OrderDateTo").val()))) {
                    checkinDate = new Date($(this).val());
                    checkoutDate = new Date($("#RoomBookingOrder_OrderDateTo").val());
                    dateDiff = checkinDate.dateDiff("d", checkoutDate);

                    if (dateDiff < 0) {
                        $(".live-num").html(0);
                    } else {
                        $(".live-num").html(dateDiff);
                    }
                } else {
                    $(".live-num").html(0);
                }
            });
            $("#RoomBookingOrder_OrderDateTo").change(function (e) {
                if ($(this).val() != "" && !isNaN(Date.parse($(this).val())) && !isNaN(Date.parse($("#RoomBookingOrder_OrderDateForm").val()))) {
                    checkinDate = new Date($("#RoomBookingOrder_OrderDateForm").val());
                    checkoutDate = new Date($(this).val());
                    dateDiff = checkinDate.dateDiff("d", checkoutDate);

                    if (dateDiff < 0) {
                        $(".live-num").html(0);
                    } else {
                        $(".live-num").html(dateDiff);
                    }
                } else {
                    $(".live-num").html(0);
                }
            });
            Date.prototype.dateDiff = function (interval, objDate) {
                //若參數不足或 objDate 不是日期物件則回傳 undefined
                if (arguments.length < 2 || objDate.constructor != Date) return undefined;
                switch (interval) {
                    case "s":
                        //計算秒差
                        return parseInt((objDate - this) / 1000);
                    case "n":
                        //計算分差
                        return parseInt((objDate - this) / 60000);
                    case "h":
                        //計算時差
                        return parseInt((objDate - this) / 3600000);
                    case "d":
                        //計算日差
                        return parseInt((objDate - this) / 86400000);
                    case "w":
                        //計算週差
                        return parseInt((objDate - this) / (86400000 * 7));
                    case "m":
                        //計算月差
                        return (objDate.getMonth() + 1) + ((objDate.getFullYear() - this.getFullYear()) * 12) - (this.getMonth() + 1);
                    case "y":
                        //計算年差
                        return objDate.getFullYear() - this.getFullYear();
                    default:
                        //輸入有誤
                        return undefined;
                }
            };

            $("#RoomBookingOrder_OrderDateForm").trigger("change");
            $("#RoomBookingOrder_OrderDateTo").trigger("change");
        });
    </script>
}